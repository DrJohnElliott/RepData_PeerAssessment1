---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

## Class project Overview
This project demonstrates the ability to create a document with embedded code.
For this example all code will be displayed but it is not necessary.
This project uses a data set provided on the Cousera web site, it was downloaded 
on May-14-2016 at this URL: 
https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip

The following libraies are used: **dplyr, lattice and ggplot2**

```{r,echo = TRUE}
        library(dplyr, quietly = TRUE ,warn.conflicts = FALSE)
        library(lattice, quietly = TRUE ,warn.conflicts = FALSE)
        library(ggplot2, quietly = TRUE ,warn.conflicts = FALSE)
    ```

## Loading and preprocessing the data

Create data set named "myData" by reading data file into envioroment with "read.csv"
        (assumes data set is located in the current working directory)
```{r,echo = TRUE}
        myData <- read.csv("activity.csv", header = TRUE, sep = "," ,dec = "." )
    ```


Create data set named "interval_Data" of the average number of steps of each interval, the original data set "myData" is grouped by interval using "grouped_by", the varible names are given better descriptive names using "rename" , then the data set is created using summarize.

```{r,echo = TRUE}
        interval_Data <- group_by(myData, interval) %>%
                rename(Average_Steps = steps, Interval = interval) %>%
                        summarize( Average_Steps = mean(Average_Steps, na.rm = TRUE))
```


## What is mean total number of steps taken per day?
Create data set named "sum_Data" representing the total steps recorded each day using "tapply"
```{r,echo = TRUE}
        sum_Data <- tapply(myData$steps, myData$date, sum, na.rm=TRUE)
```

Inspect the data set by making a Histogram to show the distribution of the total steps each day 

```{r,echo = TRUE}
        hist(sum_Data, col = "blue", main = "Histogram of Total Steps per Day", 
                xlab = "Number of Steps", breaks = 10)
```

Calculate Mean and Median of the daliy toal steps
```{r,echo = TRUE}
        meanData <- as.integer(mean(sum_Data, na.rm = TRUE))
        medianData <- as.integer(median(sum_Data, na.rm = TRUE))

```
* The mean of the total number of steps taken per day is: **`r meanData`**
* The median of the total number of steps taken per day is: **`r medianData`**

## What is the average daily activity pattern?
Create a plot of the average number of steps taken during each interval
```{r,echo = TRUE}
        g <- ggplot( data = interval_Data, aes( Interval, Average_Steps) )
        g + geom_line(colour = "blue") + labs(title = "Time Series of Average Steps Taken") +
        labs(x = "Interval  [5 minutes]", y = "Number of Steps Taken")
```



Find the interval with the maximum average value
```{r, echo=TRUE}
        maxValue <- max(interval_Data$Average_Steps, na.rm = TRUE)
        maxInterval <- interval_Data$Interval[interval_Data$Average_Steps==maxValue] 

```
* The interval with the maxium value is: **`r maxInterval`**

## Imputing missing values

Calculate total number of missing values "NA's" in the data set using "is.na"
```{r,echo = TRUE}
        missing <- sum(is.na(myData$steps))
```
*  The total number of missing values in the data is: **`r missing`**

Create new data set named "completeData" 
```{r,echo=TRUE}
        completeData <- myData

```

Find NA's in data set "completeData" 
```{r,echo=TRUE}
        whereNA <- is.na(completeData$steps)
```


Replace NA's with interval average from the data set "interval_Data"
```{r,echo=TRUE}
for(i in 1:length(whereNA)){
        if(whereNA[i] == TRUE){
                myInterval <- completeData$interval[i]
                myValue <- interval_Data$Average_Steps[interval_Data$Interval==myInterval] 
                completeData$steps[i] <- myValue
                }
}
```

Create data set named "newSum_Data" representing the total steps recorded each day using "tapply"
```{r,echo = TRUE}
        newSum_Data <- tapply(completeData$steps, completeData$date, sum)
```

Inspect the data set by making a Histogram to show the distribution of the total steps each day 

```{r,echo = TRUE}
        hist(newSum_Data, col = "blue", main = "Histogram of Total Steps per Day", xlab = "Number of Steps", breaks = 10)
```

Calculate Mean and Median of the daliy toal steps
```{r,echo = TRUE}
        new_meanData <- as.integer(mean(newSum_Data, na.rm = TRUE))
        new_medianData <- as.integer(median(newSum_Data, na.rm = TRUE))

```
* The mean of the total number of steps taken per day is: **`r new_meanData`**
* The median of the total number of steps taken per day is: **`r new_medianData`**

## Are there differences in activity patterns between weekdays and weekends?
Determine name of weekdays using "weekdays"
```{r, echo=TRUE}
        completeData$date <- as.Date.factor(completeData$date)
        which_Day <- weekdays(completeData$date)
```

Update dates by replacing date names with "Weekday" or "Weekend" 
```{r, echo=TRUE}
for(i in 1:length(which_Day)){
        if(as.character(which_Day[i])== "Saturday" | as.character(which_Day[i])== "Sunday"){
                which_Day[i] <- "Weekend"       
                
        }else{
                which_Day[i] <- "Weekday"
        }
}
```


Merge updated dates into dataset and transform into data.frame
```{r, echo=TRUE}
        which_Day <- factor(which_Day,levels=c('Weekend', 'Weekday')) 
        completeData$date <- which_Day
        dateData <- data.frame(completeData)
```


Create dataset of interval averages with updated date names
```{r, echo=TRUE}
        weekDay_Data= subset(dateData,date == "Weekday")
        weekEnd_Data= subset(dateData,date == "Weekend")
        week1 = aggregate(steps ~ interval + date, data = weekDay_Data, FUN = "mean" )
        week2 = aggregate(steps ~ interval + date, data = weekEnd_Data, FUN = "mean" )
        combinedData <- rbind.data.frame(week1,week2)
```


Plot data to compare weekend and weekday interval averages
```{r, echo=TRUE}
        xyplot(steps ~ interval | date, data = combinedData, layout = c(1,2),type = "l")
```





